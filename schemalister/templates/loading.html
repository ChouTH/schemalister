{% extends 'base.html' %}

{% block content %}

	<div class="inner">

		<h1>Salesforce Schema Lister</h1>
		<p>
			This tool uses the Salesforce REST API to build a list of objects, fields and field attributes from within your Salesforce Org.
		</p>
		<p>
			None of your organisation information or data is captured or kept from running this tool.
		</p>
					
		<div class="loading-components">

			<div style="float:left;">
				<img src="{{ STATIC_URL }}images/loading.gif" alt="Loading" title="Loading" />
			</div>

			<div style="float:left;margin-left:20px;">
				<h1 style="font-size:1.5em;margin-top:20px;">Querying objects and fields...</h1>
				<p>This can take a few minutes.</p>
			</div>

		</div>

	</div>

	<script>
 		window.setInterval(function () 
 		{
       		$.ajax({
			    url: '/job_status/{{ schema.id }}',
			    type: 'get', //this is the default though, you don't actually need to always mention it
			    success: function(resp) 
			    {
			        if (resp == 'Finished')
			        {
			        	window.location = '/schema/{{ schema.id }}/';
			        } 
			    },
			    failure: function(resp) 
			    { 
			        alert('The website returned an error trying to run your job. Please try again.');
			    }
			});
    	}, 5000);
	</script>

{% endblock %}